
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Package: ci_rvm &#8212; Vector Movement Modelling Tools</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Module: ci_rvm.ci_rvm" href="ci_rvm/ci_rvm.ci_rvm.html" />
    <link rel="prev" title="Module: hybrid_vector_model.boater_movement_model" href="hybrid_vector_model/hybrid_vector_model.boater_movement_model.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Vector Movement Modelling Tools</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="hybrid_vector_model.html">
   hybrid_vector_model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="hybrid_vector_model/hybrid_vector_model.hybrid_vector_model.html">
     hybrid_vector_model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hybrid_vector_model/hybrid_vector_model.route_choice_model.html">
     route_choice_model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hybrid_vector_model/hybrid_vector_model.statsutils.html">
     statsutils
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hybrid_vector_model/hybrid_vector_model.traveltime_model.html">
     traveltime_model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hybrid_vector_model/hybrid_vector_model.boater_movement_model.html">
     boater_movement_model
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="current reference internal" href="#">
   ci_rvm
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ci_rvm/ci_rvm.ci_rvm.html">
     ci_rvm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ci_rvm/ci_rvm.test_ci_rvm.html">
     test_ci_rvm
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="lopaths.html">
   lopaths
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="lopaths/lopaths.graph.html">
     graph
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lopaths/lopaths.graph_utils.html">
     graph_utils
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lopaths/lopaths.sig_fig_rounding.html">
     sig_fig_rounding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lopaths/lopaths.test_graph.html">
     test_graph
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lopaths/lopaths.test_routes.html">
     test_routes
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="vemomoto_core.html">
   vemomoto_core
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="vemomoto_core/vemomoto_core.concurrent.html">
     concurrent
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="vemomoto_core/concurrent/vemomoto_core.concurrent.concurrent_futures_ext.html">
       concurrent_futures_ext
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="vemomoto_core/concurrent/vemomoto_core.concurrent.nicepar.html">
       nicepar
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="vemomoto_core/concurrent/vemomoto_core.concurrent.sharedmem_ext.html">
       sharedmem_ext
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="vemomoto_core/vemomoto_core.npcollections.html">
     npcollections
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="vemomoto_core/npcollections/vemomoto_core.npcollections.FixedOrderedIntDict.html">
       FixedOrderedIntDict
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="vemomoto_core/npcollections/vemomoto_core.npcollections.intquickheapdict.html">
       intquickheapdict
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="vemomoto_core/npcollections/vemomoto_core.npcollections.npext.html">
       npext
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="vemomoto_core/npcollections/vemomoto_core.npcollections.npextc.html">
       npextc
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="vemomoto_core/npcollections/vemomoto_core.npcollections.sparse3d.html">
       sparse3d
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="vemomoto_core/vemomoto_core.tools.html">
     tools
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="vemomoto_core/tools/vemomoto_core.tools.hrprint.html">
       hrprint
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="vemomoto_core/tools/vemomoto_core.tools.iterext.html">
       iterext
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="vemomoto_core/tools/vemomoto_core.tools.saveobject.html">
       saveobject
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="vemomoto_core/tools/vemomoto_core.tools.simprofile.html">
       simprofile
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="vemomoto_core/tools/vemomoto_core.tools.tee.html">
       tee
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="vemomoto_core/tools/vemomoto_core.tools.doc_utils.html">
       doc_utils
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/ci_rvm.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installation">
   Installation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usage">
   Usage
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usage-from-r">
   Usage from R
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scientific-publication">
   Scientific Publication
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Package: ci_rvm</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installation">
   Installation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usage">
   Usage
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usage-from-r">
   Usage from R
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scientific-publication">
   Scientific Publication
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="package-ci-rvm">
<h1>Package: ci_rvm<a class="headerlink" href="#package-ci-rvm" title="Permalink to this headline">#</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="ci_rvm/ci_rvm.ci_rvm.html">ci_rvm</a></li>
<li class="toctree-l1"><a class="reference internal" href="ci_rvm/ci_rvm.test_ci_rvm.html">test_ci_rvm</a></li>
</ul>
</div>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">#</a></h2>
<p>The package can be installed via <a class="reference external" href="https://pypi.org/project/pip/">pip</a>. To install the package, you can use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">ci_rvm</span>
</pre></div>
</div>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">#</a></h2>
<p>The most convenient way to use the algorithm is to use the method
<a class="reference external" href="ci_rvm/ci_rvm.ci_rvm.html#ci_rvm.ci_rvm.find_CI">find_CI</a>. An example is below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example for finding profile likelihood confidence intervals for a</span>
<span class="c1"># negative binomial model</span>

<span class="c1"># We import some packages for convenience</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>                  <span class="c1"># for numerical operations</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>             <span class="c1"># for stats functions</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span> <span class="k">as</span> <span class="n">op</span>    <span class="c1"># to maximize the likelihood</span>

<span class="kn">from</span> <span class="nn">ci_rvm</span> <span class="kn">import</span> <span class="n">find_CI</span>          <span class="c1"># to determine confidence intervals</span>
<span class="kn">from</span> <span class="nn">ci_rvm</span> <span class="kn">import</span> <span class="n">find_function_CI</span> <span class="c1"># to determine confidence intervals</span>
                                    <span class="c1"># for functions of parameters</span>


<span class="c1"># Define the size of the data set</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Define the true parameters</span>
<span class="n">k</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.1</span>

<span class="c1"># Generate the data set</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">negative_binomial</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># Because the parameters are constrained to the positive range and the</span>
<span class="c1"># interval (0, 1), respectively, we work on a transformed parameter space</span>
<span class="c1"># with unbounded domain.</span>
<span class="k">def</span> <span class="nf">transform_parameters</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
   <span class="n">k</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">params</span>
   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">))</span>

<span class="c1"># Log-Likelihood function for a negative binomial model</span>
<span class="k">def</span> <span class="nf">logL</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">transform_parameters</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">stats</span><span class="o">.</span><span class="n">nbinom</span><span class="o">.</span><span class="n">logpmf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># negative log-Likelihood function for optimization (because we use</span>
<span class="c1"># minimization algorithms instead of maximization algorithms)</span>
<span class="n">negLogL</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">params</span><span class="p">:</span> <span class="o">-</span><span class="n">logL</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

<span class="c1"># Initial guess</span>
<span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Maximize the likelihood</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">negLogL</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>

<span class="c1"># Print the result (we need to transform the parameters to the original</span>
<span class="c1"># parameter space to make them interpretable)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The estimate is: k=</span><span class="si">{:5.3f}</span><span class="s2">, p=</span><span class="si">{:5.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">transform_parameters</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">)))</span>

<span class="c1"># Find 95% confidence intervals for all parameters.</span>
<span class="c1"># Note: For complicated problems, it is worthwhile to do this in parallel.</span>
<span class="c1">#       However, then we would need to encapsulate the procedure in a</span>
<span class="c1">#       method and define the likelihood function on the top level of the module.</span>
<span class="n">CIs</span> <span class="o">=</span> <span class="n">find_CI</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">logL</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
              <span class="n">disp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># the disp argument lets the algorithm print</span>
                         <span class="c1"># status messages.</span>

<span class="c1"># CIs is a 2D numpy array with CIs[i, 0] containing the lower bound of the</span>
<span class="c1"># confidence interval for the i-th parameter and CIs[i, 1] containing the</span>
<span class="c1"># respective upper bound.</span>

<span class="c1"># Print the confidence intervals. Note: we need to transform the parameters</span>
<span class="c1"># back to the original parameter space.</span>
<span class="n">original_lower</span> <span class="o">=</span> <span class="n">transform_parameters</span><span class="p">(</span><span class="n">CIs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">original_upper</span> <span class="o">=</span> <span class="n">transform_parameters</span><span class="p">(</span><span class="n">CIs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confidence interval for k: [</span><span class="si">{:5.3f}</span><span class="s2">, </span><span class="si">{:5.3f}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
   <span class="n">original_lower</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">original_upper</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confidence interval for n: [</span><span class="si">{:5.3f}</span><span class="s2">, </span><span class="si">{:5.3f}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
   <span class="n">original_lower</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">original_upper</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="c1"># Now we find the confidence interval for a function of the parameters,</span>
<span class="c1"># such as the sum of them</span>
<span class="k">def</span> <span class="nf">myFunction</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">transform_parameters</span><span class="p">(</span><span class="n">params</span><span class="p">))</span>

<span class="n">CI</span> <span class="o">=</span> <span class="n">find_function_CI</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">myFunction</span><span class="p">,</span> <span class="n">logL</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
                       <span class="n">disp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">CI</span><span class="p">)</span>

<span class="c1"># Computing the gradient and Hessian is necessary for the algorithm</span>
<span class="c1"># but can be computationally expensive. If you want to have full</span>
<span class="c1"># control over this, define them manually:</span>

<span class="c1"># import a package to compute gradient and Hessian numerically</span>
<span class="kn">import</span> <span class="nn">numdifftools</span> <span class="k">as</span> <span class="nn">nd</span>

<span class="c1"># Define gradient and Hessian</span>
<span class="n">jac</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">Gradient</span><span class="p">(</span><span class="n">logL</span><span class="p">)</span>
<span class="n">hess</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">Hessian</span><span class="p">(</span><span class="n">logL</span><span class="p">)</span>

<span class="n">CIs</span> <span class="o">=</span> <span class="n">find_CI</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">logL</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">jac</span><span class="p">,</span> <span class="n">hess</span><span class="o">=</span><span class="n">hess</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
              <span class="n">disp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># the disp argument lets the algorithm print</span>
                         <span class="c1"># status messages.</span>
</pre></div>
</div>
</section>
<section id="usage-from-r">
<h2>Usage from R<a class="headerlink" href="#usage-from-r" title="Permalink to this headline">#</a></h2>
<p>The package can also be used from R, if the package <cite>reticulate</cite> is available.
You may install this package via the following command:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;reticulate&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Load the package.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">reticulate</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Optional</strong>: If you want to use a python installation that already
exists on your system, make sure it is in the PATH
environment variable so that it can be found by R. Otherwise,
specify your python executable via</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">use_python</span><span class="p">(</span><span class="s">&quot;/my/path/to/python&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Optional</strong>: If you use python via Anaconda, you can activate your environment of
preference via the command below. If you are not sure what this
does, you are presumably fine and can omit this line.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">use_virtualenv</span><span class="p">(</span><span class="s">&quot;base&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, “base” is the name of the environment.</p>
<hr class="docutils" />
<p>If the package with the algorithm is not installed on your system yet, run</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">py_install</span><span class="p">(</span><span class="s">&quot;ci-rvm&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pip</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
<p>If python is not yet installed on your system, you will be asked
to install Miniconda when loading the package. We advise you to do this.</p>
<p>Now everything should be set up for using the algorithm.
Below you can find an example R script.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1"># ========== imports ===========</span>

<span class="c1"># We start by importing the library that builds a bridge to python.</span>
<span class="nf">library</span><span class="p">(</span><span class="n">reticulate</span><span class="p">)</span>

<span class="c1"># Now we import the python package to compute profile likelihood confidence</span>
<span class="c1"># intervals.</span>
<span class="n">ci_rvm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">import</span><span class="p">(</span><span class="s">&quot;ci_rvm&quot;</span><span class="p">)</span>


<span class="c1"># ========== loading data and defining likelihood function ===========</span>

<span class="c1"># We consider the built-in data on height an weight of women. We assume that the</span>
<span class="c1"># weight is normally distributed around a polynomial function of the height:</span>
<span class="c1"># meanWeight = a + b * height^c</span>
<span class="c1"># where a, b, and c are parameters.</span>
<span class="c1"># We assume that the variance is proportional to the mean height:</span>
<span class="c1"># varianceWeight = d * meanWeight</span>
<span class="c1"># The log-likelihood function looks as follows (up to a constant)</span>

<span class="n">logLikelihood</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="w"> </span><span class="c1"># constrain this parameter to the positive range</span>
<span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parameters</span><span class="p">[</span><span class="m">2</span><span class="p">]</span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="m">3</span><span class="p">])</span><span class="w"> </span><span class="c1"># constrain this parameter to the positive range</span>
<span class="w">    </span><span class="n">meanWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">women</span><span class="p">[</span><span class="s">&quot;height&quot;</span><span class="p">]</span><span class="o">^</span><span class="n">b</span>
<span class="w">    </span><span class="n">varianceWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">meanWeight</span>

<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="nf">sum</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">varianceWeight</span><span class="p">))</span><span class="o">/</span><span class="m">2</span>
<span class="w">              </span><span class="o">-</span><span class="nf">sum</span><span class="p">((</span><span class="n">women</span><span class="p">[</span><span class="s">&quot;weight&quot;</span><span class="p">]</span><span class="o">-</span><span class="n">meanWeight</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="o">/</span><span class="p">(</span><span class="m">2</span><span class="o">*</span><span class="n">varianceWeight</span><span class="p">)))</span>
<span class="w">    </span><span class="nf">return</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="p">}</span>


<span class="c1"># ========== defining gradient and Hessian of the log-likelihood ===========</span>

<span class="c1"># Maximizing the likelihood and finding confidence intervals requires knowledge</span>
<span class="c1"># of the gradient (vector of first derivatives) and Hessian</span>
<span class="c1"># (matrix of second derivatives) of the log-likelihood function.</span>
<span class="c1"># For the considered example, we could compute these by hand on paper. However,</span>
<span class="c1"># to show how we could proceed in more complicated cases, we use packages to</span>
<span class="c1"># compute the derivatives.</span>
<span class="c1"># If we do not provide gradient and Hessian, the package will compute them</span>
<span class="c1"># for us, but this could potentially be less efficient when working from R.</span>

<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;numDeriv&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1"># omit this line, if the library is already installed</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&quot;numDeriv&quot;</span><span class="p">)</span>

<span class="n">gradientLL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">return</span><span class="p">(</span><span class="nf">grad</span><span class="p">(</span><span class="n">logLikelihood</span><span class="p">,</span><span class="w"> </span><span class="n">parameters</span><span class="p">))</span>
<span class="p">}</span>

<span class="n">hessianLL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">return</span><span class="p">(</span><span class="nf">hessian</span><span class="p">(</span><span class="n">logLikelihood</span><span class="p">,</span><span class="w"> </span><span class="n">parameters</span><span class="p">))</span>
<span class="p">}</span>


<span class="c1"># ========== maximizing the likelihood ===========</span>

<span class="c1"># define initial guess</span>
<span class="n">guess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>

<span class="c1"># maximize the likelihood</span>
<span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">optim</span><span class="p">(</span><span class="n">guess</span><span class="p">,</span><span class="w"> </span><span class="n">logLikelihood</span><span class="p">,</span><span class="w"> </span><span class="n">gr</span><span class="o">=</span><span class="n">gradientLL</span><span class="p">,</span>
<span class="w">               </span><span class="n">control</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">fnscale</span><span class="o">=</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">maxit</span><span class="o">=</span><span class="m">3000</span><span class="p">,</span><span class="w"> </span><span class="n">trace</span><span class="o">=</span><span class="m">0</span><span class="p">))</span>

<span class="c1"># estimated parameters</span>
<span class="n">estimate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="o">$</span><span class="n">par</span>

<span class="c1"># check the result by plotting estimated mean and data</span>
<span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">women</span><span class="p">[</span><span class="s">&quot;height&quot;</span><span class="p">])</span><span class="m">-5</span><span class="p">)</span><span class="o">:</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">women</span><span class="p">[</span><span class="s">&quot;height&quot;</span><span class="p">])</span><span class="m">+5</span><span class="p">)</span>
<span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">estimate</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">height</span><span class="o">^</span><span class="n">estimate</span><span class="p">[</span><span class="m">2</span><span class="p">]</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">height</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">)</span>
<span class="nf">points</span><span class="p">(</span><span class="nf">unlist</span><span class="p">(</span><span class="n">women</span><span class="p">[</span><span class="s">&quot;height&quot;</span><span class="p">],</span><span class="w"> </span><span class="n">use.names</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">),</span><span class="w"> </span><span class="nf">unlist</span><span class="p">(</span><span class="n">women</span><span class="p">[</span><span class="s">&quot;weight&quot;</span><span class="p">],</span><span class="w"> </span><span class="n">use.names</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">))</span>


<span class="c1"># ========== computing profile likelihood confidence intervals ===========</span>

<span class="c1"># Compute all confidence intervals at once. We obtain a matrix with a row for</span>
<span class="c1"># each parameter and the lower and upper confidence interval limit as columns.</span>
<span class="c1"># If return_success=TRUE, a second matrix will be returned, indicating which</span>
<span class="c1"># of the bounds have been found with success.</span>
<span class="c1"># Set disp=TRUE to print status information. Especially if something goes wrong</span>
<span class="c1"># (which could, e.g., happen if the provided estimate is not close to the actual</span>
<span class="c1"># maximum), this information can be very useful.</span>
<span class="c1"># alpha denotes the desired confidence level (0.95 by default)</span>
<span class="n">confidenceIntervals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ci_rvm</span><span class="o">$</span><span class="nf">find_CI</span><span class="p">(</span><span class="n">estimate</span><span class="p">,</span><span class="w"> </span><span class="n">logLikelihood</span><span class="p">,</span><span class="w"> </span><span class="n">gradientLL</span><span class="p">,</span>
<span class="w">                                     </span><span class="n">hessianLL</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.95</span><span class="p">,</span><span class="w"> </span><span class="n">disp</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span>
<span class="w">                                     </span><span class="n">return_success</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">confidenceIntervals</span><span class="p">)</span>

<span class="c1"># Note that automatic parallel search for multiple confidence interval bounds</span>
<span class="c1"># does not work if the code is called from R. You will have to do the</span>
<span class="c1"># parallelization manually from within R. To that end, you can determine an</span>
<span class="c1"># individual confidence interval bound as follows.</span>

<span class="c1"># Set the index of the parameter under investigation. Note that python indices</span>
<span class="c1"># start at 0.</span>
<span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>

<span class="c1"># Set the search direction. Use a positive value or TRUE to find the upper</span>
<span class="c1"># end point of the confidence interval and a negative value or FALSE to find</span>
<span class="c1"># the lower end point.</span>
<span class="n">direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1</span>

<span class="c1"># Now execute the search.</span>
<span class="n">confidenceInterval1Lower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ci_rvm</span><span class="o">$</span><span class="nf">find_CI</span><span class="p">(</span><span class="n">estimate</span><span class="p">,</span><span class="w"> </span><span class="n">logLikelihood</span><span class="p">,</span>
<span class="w">    </span><span class="n">gradientLL</span><span class="p">,</span><span class="w"> </span><span class="n">hessianLL</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">direction</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.95</span><span class="p">,</span><span class="w"> </span><span class="n">disp</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span>
<span class="w">    </span><span class="n">track_x</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">            </span><span class="c1"># If we want to track what the algorithm did</span>
<span class="w">    </span><span class="n">return_full_results</span><span class="o">=</span><span class="kc">TRUE</span><span class="w"> </span><span class="c1"># If we want to access details on the result</span>
<span class="w">    </span><span class="p">)</span>

<span class="c1"># The resulting object also contains information on what the other parameters</span>
<span class="c1"># were when the parameter under consideration assumed its extreme value.</span>
<span class="c1"># This information can be helpful to detect connections between parameters.</span>
<span class="nf">print</span><span class="p">(</span><span class="n">confidenceInterval1Lower</span><span class="o">$</span><span class="n">x</span><span class="p">)</span>


<span class="c1"># ------- additional fun stuff ---------</span>

<span class="c1"># Similarly, we could plot the trajectory of the search, This requires that</span>
<span class="c1"># track_x=TRUE when searching the confidence interval.</span>
<span class="c1"># First, we plot the relationship between the first two parameters.</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">confidenceInterval1Lower</span><span class="o">$</span><span class="n">x_track</span><span class="p">[,</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">confidenceInterval1Lower</span><span class="o">$</span><span class="n">x_track</span><span class="p">[,</span><span class="m">2</span><span class="p">],</span>
<span class="w">     </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;o&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;Weight factor&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">&quot;Weight exponent&quot;</span><span class="p">)</span>

<span class="c1"># The line above seems to be super straight and we may wonder why so many</span>
<span class="c1"># steps were needed to find the confidence interval end point.</span>
<span class="c1"># Let us consider the relationship between the first and the third parameter.</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">confidenceInterval1Lower</span><span class="o">$</span><span class="n">x_track</span><span class="p">[,</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">confidenceInterval1Lower</span><span class="o">$</span><span class="n">x_track</span><span class="p">[,</span><span class="m">3</span><span class="p">],</span>
<span class="w">     </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;o&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;Weight factor&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">&quot;Variance factor&quot;</span><span class="p">)</span>

<span class="c1"># We see the search trajectory is curved - a sign that the likelihood surface</span>
<span class="c1"># is not trivial.</span>

<span class="c1"># When we compute the Wald confidence intervals for comparison, we see that</span>
<span class="c1"># they are good for the first two parameters, but not as good for the last</span>
<span class="c1"># one:</span>
<span class="n">deviation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="o">-</span><span class="nf">diag</span><span class="p">(</span><span class="nf">solve</span><span class="p">(</span><span class="nf">hessianLL</span><span class="p">(</span><span class="n">estimate</span><span class="p">)))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">qchisq</span><span class="p">(</span><span class="m">0.95</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>
<span class="n">waldCI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cbind</span><span class="p">(</span><span class="n">estimate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">deviation</span><span class="p">,</span><span class="w"> </span><span class="n">estimate</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">deviation</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">&quot;Wald CI&quot;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">waldCI</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">&quot;Profile CI&quot;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">confidenceIntervals</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">&quot;Relative Error&quot;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">waldCI</span><span class="o">/</span><span class="n">confidenceIntervals</span><span class="p">)</span>

<span class="c1"># ------------</span>

<span class="c1"># We can also compute the confidence interval for a function of parameters,</span>
<span class="c1"># such as the mean expected value of the distribution</span>

<span class="n">meanExpectedValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="w"> </span><span class="c1"># constrain this parameter to the positive range</span>
<span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parameters</span><span class="p">[</span><span class="m">2</span><span class="p">]</span>
<span class="w">    </span><span class="n">meanWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">women</span><span class="p">[</span><span class="s">&quot;height&quot;</span><span class="p">]</span><span class="o">^</span><span class="n">b</span>
<span class="w">    </span><span class="nf">return</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">meanWeight</span><span class="p">))</span>
<span class="p">}</span>

<span class="n">gradientMean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">return</span><span class="p">(</span><span class="nf">grad</span><span class="p">(</span><span class="n">meanExpectedValue</span><span class="p">,</span><span class="w"> </span><span class="n">parameters</span><span class="p">))</span>
<span class="p">}</span>

<span class="n">hessianMean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">return</span><span class="p">(</span><span class="nf">hessian</span><span class="p">(</span><span class="n">meanExpectedValue</span><span class="p">,</span><span class="w"> </span><span class="n">parameters</span><span class="p">))</span>
<span class="p">}</span>

<span class="n">ciOfMean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ci_rvm</span><span class="o">$</span><span class="nf">find_function_CI</span><span class="p">(</span><span class="n">estimate</span><span class="p">,</span><span class="w"> </span><span class="n">meanExpectedValue</span><span class="p">,</span><span class="w"> </span><span class="n">logLikelihood</span><span class="p">,</span>
<span class="w">                                   </span><span class="n">gradientMean</span><span class="p">,</span><span class="w"> </span><span class="n">hessianMean</span><span class="p">,</span><span class="w"> </span><span class="n">gradientLL</span><span class="p">,</span>
<span class="w">                                   </span><span class="n">hessianLL</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.95</span><span class="p">,</span><span class="w"> </span><span class="n">disp</span><span class="o">=</span><span class="kc">FALSE</span>
<span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">ciOfMean</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="scientific-publication">
<h2>Scientific Publication<a class="headerlink" href="#scientific-publication" title="Permalink to this headline">#</a></h2>
<p>The theory behind the algorithm implemented in this package is explained in the paper “<a class="reference external" href="https://link.springer.com/article/10.1007/s11222-021-10012-y">A robust and efficient algorithm to find profile likelihood confidence intervals</a>”. Please cite this publication if you have used the package in your own research.</p>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="hybrid_vector_model/hybrid_vector_model.boater_movement_model.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Module: hybrid_vector_model.boater_movement_model</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="ci_rvm/ci_rvm.ci_rvm.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Module: ci_rvm.ci_rvm</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Samuel M. Fischer<br/>
  
      &copy; Copyright 2020, Samuel M. Fischer.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>